<ion-header>
  <ion-toolbar>
    <ion-title style="text-align: center;">Profilim</ion-title>
  </ion-toolbar>
</ion-header>
<ion-content class="ion-padding" [fullscreen]="true">
  <div style="width: 100%; display: flex; justify-content: center; align-items: center;">
    <div style="border-radius: 5px; display: flex; background-color: rgba(0, 146, 129, 1); height: 125px; width: 100%;">
      <div style="width: 30%; display: flex; justify-content: center; align-items: center; padding: 5px;">
        <ng-container *ngIf="type === 'user'">
          <img *ngIf="!accountformUser.value.resim" src="../../../assets/demoavatar.png"
            style="width: 80px; height: 80px; border-radius: 50%;" />
          <img *ngIf="accountformUser.value.resim" src="{{serverpath}}/{{accountformUser.value.resim}}"
            style="width: 80px; height: 80px; border-radius: 50%;" />

        </ng-container>

        <ng-container *ngIf="type === 'psikolog'">
          <img *ngIf="!accountformPsikolog.value.resim" src="../../../assets/demoavatar.png"
            style="width: 80px; height: 80px; border-radius: 50%;" />
          <img *ngIf="accountformPsikolog.value.resim" src="{{serverpath}}/{{accountformPsikolog.value.resim}}"
            style="width: 80px; height: 80px; border-radius: 50%;" />
        </ng-container>

      </div>
      <div *ngIf="type !== 'user'"
        style="width: 70%; display: flex; flex-direction: column; gap: 10px; padding: 10px; justify-content: center;">
        <h2 style="padding-left: 0 !important;">{{writeNamePsikolog()}}</h2>
        <p>{{psikologkategoriler[0]}}</p>
        <ng-container *ngIf="psikologkategoriler">
          <ng-container *ngFor="let kategori of psikologkategoriler">
            <p>{{kategori.baslik}}</p>
          </ng-container>
        </ng-container>
      </div>
      <div *ngIf="type === 'user'"
        style="width: 70%; display: flex; flex-direction: column; gap: 10px; padding: 10px; justify-content: center;">
        <h2>{{writeNameUser()}}</h2>
      </div>

    </div>
  </div>


  <h2 style="font-size: 20px; margin-top: 30px !important; margin-bottom: 20px !important; color: #5a5353;">Ayarlar</h2>
  <ion-list>
    <ion-item [button]="true" id="hesabim">
      <ion-icon slot="start" name="settings-outline" size="medium"></ion-icon>
      <ion-label>Hesap Bilgileri</ion-label>
      <ion-note slot="end">Yönet</ion-note>
      <ion-modal trigger="hesabim" #modal1>
        <ng-template>
          <ion-header>
            <ion-toolbar>
              <ion-buttons slot="start">
                <ion-button (click)="cancel(modal1)" [strong]="true">İptal</ion-button>
              </ion-buttons>
            </ion-toolbar>
          </ion-header>
          <ion-content class="ion-padding">
            <form *ngIf="type !== 'user'" [formGroup]="accountformPsikolog" (ngSubmit)="accountFormPsikologSubmit()">
              <br>
              <ion-input formControlName="adsoyad" label="Ad Soyad" label-placement="floating" fill="outline"
                placeholder="Ad Soyad Giriniz."></ion-input>
              <br>
              <ion-input formControlName="yas" label="Yaş" type="number" label-placement="floating" fill="outline"
                placeholder="Yaş Giriniz."></ion-input>
              <br>
              <ion-textarea formControlName="hakkimda" autocapitalize="on" rows="10" [counter]="true" maxlength="1000"
                [counterFormatter]="customCounterFormatter" label="Hakkımda" labelPlacement="floating" fill="outline"
                placeholder="Hakkımda Giriniz."></ion-textarea>
              <br>
              <ion-input formControlName="universite" label="Üniversite" label-placement="floating" fill="outline"
                placeholder="Üniversite Giriniz."></ion-input>
              <br>
              <ion-input formControlName="bolum" label="Bölüm" label-placement="floating" fill="outline"
                placeholder="Bölüm Giriniz."></ion-input>
              <br>
              <ion-select formControlName="kategori" label="Branş Kategorisi" label-placement="floating" fill="outline"
                multiple="true">
                <ion-select-option *ngFor="let kategori of kategoriler" [value]="kategori.baslik"
                  [selected]="psikologkategoriler.includes(kategori.baslik)">
                  {{kategori.baslik}}
                </ion-select-option>
              </ion-select>




              <br>
              <ion-select formControlName="cinsiyet" label="Cinsiyet" label-placement="floating" fill="outline">
                <ion-select-option value="erkek">Erkek</ion-select-option>
                <ion-select-option value="kadin">Kadın</ion-select-option>
              </ion-select>
              <br>
              <br>
              <br>
              <ion-input formControlName="ozellik1" label="1- Kendinizi Tanımlayan En İyi Kelime"
                label-placement="floating" fill="outline"></ion-input>
              <br>
              <ion-input formControlName="ozellik2" label="2- Kendinizi Tanımlayan En İyi Kelime"
                label-placement="floating" fill="outline"></ion-input>
              <br>
              <ion-input formControlName="ozellik3" label="3- Kendinizi Tanımlayan En İyi Kelime"
                label-placement="floating" fill="outline"></ion-input>
              <br>
              <ion-input formControlName="ozellik4" label="4- Kendinizi Tanımlayan En İyi Kelime"
                label-placement="floating" fill="outline"></ion-input>
              <br>
              <ion-input formControlName="ozellik5" label="5- Kendinizi Tanımlayan En İyi Kelime"
                label-placement="floating" fill="outline"></ion-input>
              <br>


              <ion-button (click)="uploadPhoto()" expand="block" fill="outline">
                <ion-icon style="background: none !important;" slot="start" name="camera"></ion-icon>
                Fotoğraf Yükle
              </ion-button>
              <br>
              <ion-button type="submit" fill="outline" expand="block">
                Güncelle
              </ion-button>
            </form>
            <form *ngIf="type === 'user'" [formGroup]="accountformUser" (ngSubmit)="accountFormUserSubmit()">
              <br>
              <ion-input formControlName="adsoyad" label="Ad Soyad" label-placement="floating" fill="outline"
                placeholder="Ad Soyad Giriniz."></ion-input>
              <br>
              <ion-input formControlName="yas" label="Yaş" type="number" label-placement="floating" fill="outline"
                placeholder="Yaş Giriniz."></ion-input>
              <br>
              <ion-select formControlName="cinsiyet" label="Cinsiyet" label-placement="floating" fill="outline">
                <ion-select-option value="erkek">Erkek</ion-select-option>
                <ion-select-option value="kadin">Kadın</ion-select-option>
              </ion-select>
              <br>
              <ion-button (click)="uploadPhoto()" expand="block" class="custombutton" fill="outline">
                <ion-icon style="background-color: unset !important;" slot="start" name="camera"></ion-icon>
                Fotoğraf Yükle
              </ion-button>
              <br>
              <ion-button type="submit" expand="block" fill="outline">
                Güncelle
              </ion-button>
            </form>

          </ion-content>


        </ng-template>
      </ion-modal>
    </ion-item>

    <ion-item *ngIf="type !== 'user'" [button]="true" id="odeme">
      <ion-icon slot="start" name="card-outline" size="medium"></ion-icon>
      <ion-label>Ödeme Bilgileri</ion-label>
      <ion-note slot="end">Yönet</ion-note>
      <ion-modal trigger="odeme" #modal2>
        <ng-template>
          <ion-header>
            <ion-toolbar>
              <ion-buttons slot="start">
                <ion-button (click)="cancel(modal2)" [strong]="true">İptal</ion-button>
              </ion-buttons>
            </ion-toolbar>
          </ion-header>
          <ion-content class="ion-padding">
            <form [formGroup]="balanceformPsikolog" (ngSubmit)="balanceFormPsikologSubmit()">
              <br>
              <ion-input formControlName="IBAN" label="IBAN" label-placement="floating" fill="outline"
                placeholder="IBAN"></ion-input>
              <br>
              <ion-input type="number" formControlName="fiyat" label="Seans Ücreti" label-placement="floating"
                fill="outline" placeholder="Seans Ücreti"></ion-input>
              <br>
              <ion-item lines="none">
                <ion-label>Aktarılacak Bakiye</ion-label>
                <ion-badge color="primary" slot="end" color="success">
                  {{balance}} ₺
                </ion-badge>
              </ion-item>

              <ion-button type="submit" fill="outline" expand="block">
                Güncelle
              </ion-button>
            </form>
          </ion-content>
        </ng-template>
      </ion-modal>
    </ion-item>
    <ion-item *ngIf="type !== 'user'" [button]="true" id="seans">
      <ion-icon  slot="start" name="construct-outline" size="medium"></ion-icon>
      <ion-label>Seans Ayarlarım</ion-label>
      <ion-note slot="end">Yönet</ion-note>
      <ion-modal trigger="seans" #modal3>
        <ng-template>
          <ion-header>
            <ion-toolbar>
              <ion-buttons slot="start">
                <ion-button (click)="cancel(modal3)" [strong]="true">İptal</ion-button>
              </ion-buttons>
            </ion-toolbar>
          </ion-header>
          <ion-content class="ion-padding">
            <h2 style="color: #5a5353; margin: 20px 0px !important;">Çalışma Planı</h2>
            <ion-list *ngIf="seanslar.length > 0" style="margin-bottom: 30px;">

              <ion-item *ngFor="let seans of seanslar">
                <div style="width: 100%; display: flex; justify-content: space-between; align-items: center;">
                  <ion-label>
                    {{seans.tarih}}: {{seans.baslangicsaat}} - {{seans.bitissaat}}
                  </ion-label>
                  <b *ngIf="seans.dolu; else NoDolu" style="color: #E74C3C;">
                    Dolu
                  </b>
                  <ng-template #NoDolu>
                    <b style="color: #2ECC71;">Boş</b>
                  </ng-template>
                </div>


              </ion-item>
            </ion-list>
            <h2 style="color: #5a5353; margin-bottom: 50px !important; font-size: 15px;" *ngIf="seanslar.length === 0">
              Henüz Seansınız Yok</h2>


            <h2 style="color: #5a5353; margin: 20px 0px !important;">Seans Günü Ekle</h2>

            <ion-item>
              <ion-datetime (ionChange)="onDateChange($event)"  [value]="selectDay" presentation="date"></ion-datetime>
            </ion-item>

            <ion-item>
              <ion-list style="width: 100%;">
                <ion-item>
                  <ion-select aria-label="hours" placeholder="Select hour" [multiple]="true"     (ionChange)="onHoursChange($event)" >
                    <ion-select-option *ngFor="let hour of hours" [value]="hour">{{ hour }}:00</ion-select-option>
                  </ion-select>
                </ion-item>
              </ion-list>
            </ion-item>

            <ion-button (click)="addMultipleSeans()" expand="block" fill="outline" type="submit">Ekle</ion-button>

          </ion-content>
        </ng-template>
      </ion-modal>
    </ion-item>

    <ion-item (click)="logout()" [button]="true">
      <ion-icon slot="start" name="log-out-outline" size="medium"></ion-icon>
      <ion-label>Çıkış Yap</ion-label>
    </ion-item>
    <ion-item lines="none"
      *ngIf="!(accountformPsikolog.value.adsoyad && accountformPsikolog.value.resim) && type !== 'user'">
      <ion-text style="font-size: 13px; color: #5a5353;">Profilinizin yayınlanması için profil fotoğrafını, hesabınızı
        ve ödeme bilgilerinizi güncelleyin.</ion-text>
    </ion-item>
    <ion-item lines="none" *ngIf="!(accountformUser.value.adsoyad && accountformUser.value.resim) && type === 'user'">
      <ion-text style="font-size: 13px; color: #5a5353;">Profilinizin yayınlanması için profil fotoğrafını ve hesabınızı
        güncelleyin.</ion-text>
    </ion-item>
  </ion-list>
</ion-content>
